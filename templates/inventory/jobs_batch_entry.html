{% extends 'inventory/base.html' %}
{% load static %}

{% block body %}
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
  {% endif %}

  <form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <input type="file" name="jobs_sheet" /> <!-- ðŸ‘ˆ this name must match -->
    <button type="submit">Upload</button>
  </form>

  {% if data %}
    <h2>Review & Submit Jobs</h2> <a href="{% url 'create_all_batch_jobs' %}">Add job</a>

    {% for item in data %}
      <form method="POST" action="{% url 'create_batch_jobs' %}">
        {% csrf_token %}
        <input type="hidden" name="job_id" value="{{ item.job_id }}" />
        <input type="hidden" name="date" value="{{ item.date }}" />
        <input type="hidden" name="from_time" value="{{ item.from_time }}" />
        <input type="hidden" name="parent_account" value="{{ item.parent_account }}" />
        <input type="hidden" name="status" value="{{ item.status }}" />

        <input type="hidden" name="postcode" value="{{ item.postcode }}" />
        <input type="hidden" name="engineer" value="{{ item.engineer }}" />
        <input type="hidden" name="notes" value="{{ item.notes }}" />
        <input type="hidden" name="birthday" value="{{ item.birthday }}" />
        <input type="hidden" name="address" value="{{ item.address }}" />

        <p>
          <strong>Job#':</strong> {{ item.job_id }}
        </p>
        <p>
          <strong>Date:</strong> {{ item.date }}
        </p>
        <p>
          <strong>Time:</strong> {{ item.from_time }}
        </p>
        <p>
          <strong>Status:</strong> {{ item.status }}
        </p>
        <p>
          <strong>Parent Customer:</strong> {{ item.parent_account }}
        </p>
        <p>
          <strong>Address:</strong> {{ item.address }}
        </p>
        <p>
          <strong>Postcode:</strong> {{ item.postcode }}
        </p>
        <p>
          <strong>Engineer:</strong> {{ item.engineer }}
        </p>
        <p>
          <strong>Completion Notes:</strong> {{ item.notes }}
        </p>
        <p>
          <strong>Job Birthday:</strong> {{ item.created_at }}
        </p>
        <button type="submit">Add job</button>
      </form>
      <hr />
    {% endfor %}
    <form method="POST" action="{% url 'clear_batch' %}">
      {% csrf_token %}
      <button type="submit">Clear All</button>
    </form>
  {% endif %}

  <link rel="stylesheet" href="{% static 'css/style.css' %}" />

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
{% endblock %}
